{"ast":null,"code":"import { BehaviorSubject } from \"rxjs\";\nimport { tap } from \"rxjs/operators\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class AuthService {\n  constructor(http) {\n    this.http = http;\n    this.apiUrl = \"http://localhost:8080/api/auth\";\n    this.currentUserSubject = new BehaviorSubject(null);\n    this.currentUser$ = this.currentUserSubject.asObservable();\n    // Check if user is already logged in\n    const token = localStorage.getItem(\"authToken\");\n    if (token) {\n      // You might want to validate the token with the backend\n      this.getCurrentUser().subscribe();\n    }\n  }\n  login(credentials) {\n    return this.http.post(`${this.apiUrl}/login`, credentials).pipe(tap(response => {\n      const token = response.data?.token;\n      const user = response.data?.user;\n      localStorage.setItem(\"authToken\", token);\n      this.currentUserSubject.next(user);\n    }));\n  }\n  register(userData) {\n    return this.http.post(`${this.apiUrl}/register`, userData).pipe(tap(response => {\n      const token = response.data?.token;\n      const user = response.data?.user;\n      if (token) localStorage.setItem(\"authToken\", token);\n      if (user) this.currentUserSubject.next(user);\n    }));\n  }\n  forgotPassword(email) {\n    return this.http.post(`${this.apiUrl}/forgot-password`, {\n      email\n    });\n  }\n  logout() {\n    localStorage.removeItem(\"authToken\");\n    this.currentUserSubject.next(null);\n  }\n  getCurrentUser() {\n    return this.http.get(`${this.apiUrl}/me`);\n  }\n  isAuthenticated() {\n    return !!localStorage.getItem(\"authToken\");\n  }\n  getToken() {\n    return localStorage.getItem(\"authToken\");\n  }\n  static {\n    this.ɵfac = function AuthService_Factory(t) {\n      return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: AuthService,\n      factory: AuthService.ɵfac,\n      providedIn: \"root\"\n    });\n  }\n}","map":{"version":3,"names":["BehaviorSubject","tap","AuthService","constructor","http","apiUrl","currentUserSubject","currentUser$","asObservable","token","localStorage","getItem","getCurrentUser","subscribe","login","credentials","post","pipe","response","data","user","setItem","next","register","userData","forgotPassword","email","logout","removeItem","get","isAuthenticated","getToken","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["C:\\Users\\foulm\\Downloads\\v12\\src\\app\\services\\auth.service.ts"],"sourcesContent":["import { Injectable } from \"@angular/core\"\nimport { HttpClient } from \"@angular/common/http\"\nimport { type Observable, BehaviorSubject } from \"rxjs\"\nimport { tap } from \"rxjs/operators\"\n\nexport interface User {\n  id: number\n  username: string\n  email: string\n  firstName: string\n  lastName: string\n}\n\nexport interface LoginRequest {\n  username: string\n  password: string\n}\n\nexport interface RegisterRequest {\n  username: string\n  email: string\n  password: string\n  firstName: string\n  lastName: string\n}\n\nexport interface AuthResponse {\n  token: string\n  user: User\n}\n\n@Injectable({\n  providedIn: \"root\",\n})\nexport class AuthService {\n  private apiUrl = \"http://localhost:8080/api/auth\"\n  private currentUserSubject = new BehaviorSubject<User | null>(null)\n  public currentUser$ = this.currentUserSubject.asObservable()\n\n  constructor(private http: HttpClient) {\n    // Check if user is already logged in\n    const token = localStorage.getItem(\"authToken\")\n    if (token) {\n      // You might want to validate the token with the backend\n      this.getCurrentUser().subscribe()\n    }\n  }\n\n  login(credentials: LoginRequest): Observable<any> {\n    return this.http.post<any>(`${this.apiUrl}/login`, credentials).pipe(\n      tap((response) => {\n        const token = response.data?.token;\n        const user = response.data?.user;\n        localStorage.setItem(\"authToken\", token);\n        this.currentUserSubject.next(user);\n      }),\n    );\n  }\n\n  register(userData: RegisterRequest): Observable<any> {\n    return this.http.post<any>(`${this.apiUrl}/register`, userData).pipe(\n      tap((response) => {\n        const token = response.data?.token;\n        const user = response.data?.user;\n        if (token) localStorage.setItem(\"authToken\", token);\n        if (user) this.currentUserSubject.next(user);\n      }),\n    );\n  }\n\n  forgotPassword(email: string): Observable<any> {\n    return this.http.post(`${this.apiUrl}/forgot-password`, { email })\n  }\n\n  logout(): void {\n    localStorage.removeItem(\"authToken\")\n    this.currentUserSubject.next(null)\n  }\n\n  getCurrentUser(): Observable<User> {\n    return this.http.get<User>(`${this.apiUrl}/me`)\n  }\n\n  isAuthenticated(): boolean {\n    return !!localStorage.getItem(\"authToken\")\n  }\n\n  getToken(): string | null {\n    return localStorage.getItem(\"authToken\")\n  }\n}\n"],"mappings":"AAEA,SAA0BA,eAAe,QAAQ,MAAM;AACvD,SAASC,GAAG,QAAQ,gBAAgB;;;AA+BpC,OAAM,MAAOC,WAAW;EAKtBC,YAAoBC,IAAgB;IAAhB,KAAAA,IAAI,GAAJA,IAAI;IAJhB,KAAAC,MAAM,GAAG,gCAAgC;IACzC,KAAAC,kBAAkB,GAAG,IAAIN,eAAe,CAAc,IAAI,CAAC;IAC5D,KAAAO,YAAY,GAAG,IAAI,CAACD,kBAAkB,CAACE,YAAY,EAAE;IAG1D;IACA,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC;IAC/C,IAAIF,KAAK,EAAE;MACT;MACA,IAAI,CAACG,cAAc,EAAE,CAACC,SAAS,EAAE;;EAErC;EAEAC,KAAKA,CAACC,WAAyB;IAC7B,OAAO,IAAI,CAACX,IAAI,CAACY,IAAI,CAAM,GAAG,IAAI,CAACX,MAAM,QAAQ,EAAEU,WAAW,CAAC,CAACE,IAAI,CAClEhB,GAAG,CAAEiB,QAAQ,IAAI;MACf,MAAMT,KAAK,GAAGS,QAAQ,CAACC,IAAI,EAAEV,KAAK;MAClC,MAAMW,IAAI,GAAGF,QAAQ,CAACC,IAAI,EAAEC,IAAI;MAChCV,YAAY,CAACW,OAAO,CAAC,WAAW,EAAEZ,KAAK,CAAC;MACxC,IAAI,CAACH,kBAAkB,CAACgB,IAAI,CAACF,IAAI,CAAC;IACpC,CAAC,CAAC,CACH;EACH;EAEAG,QAAQA,CAACC,QAAyB;IAChC,OAAO,IAAI,CAACpB,IAAI,CAACY,IAAI,CAAM,GAAG,IAAI,CAACX,MAAM,WAAW,EAAEmB,QAAQ,CAAC,CAACP,IAAI,CAClEhB,GAAG,CAAEiB,QAAQ,IAAI;MACf,MAAMT,KAAK,GAAGS,QAAQ,CAACC,IAAI,EAAEV,KAAK;MAClC,MAAMW,IAAI,GAAGF,QAAQ,CAACC,IAAI,EAAEC,IAAI;MAChC,IAAIX,KAAK,EAAEC,YAAY,CAACW,OAAO,CAAC,WAAW,EAAEZ,KAAK,CAAC;MACnD,IAAIW,IAAI,EAAE,IAAI,CAACd,kBAAkB,CAACgB,IAAI,CAACF,IAAI,CAAC;IAC9C,CAAC,CAAC,CACH;EACH;EAEAK,cAAcA,CAACC,KAAa;IAC1B,OAAO,IAAI,CAACtB,IAAI,CAACY,IAAI,CAAC,GAAG,IAAI,CAACX,MAAM,kBAAkB,EAAE;MAAEqB;IAAK,CAAE,CAAC;EACpE;EAEAC,MAAMA,CAAA;IACJjB,YAAY,CAACkB,UAAU,CAAC,WAAW,CAAC;IACpC,IAAI,CAACtB,kBAAkB,CAACgB,IAAI,CAAC,IAAI,CAAC;EACpC;EAEAV,cAAcA,CAAA;IACZ,OAAO,IAAI,CAACR,IAAI,CAACyB,GAAG,CAAO,GAAG,IAAI,CAACxB,MAAM,KAAK,CAAC;EACjD;EAEAyB,eAAeA,CAAA;IACb,OAAO,CAAC,CAACpB,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC;EAC5C;EAEAoB,QAAQA,CAAA;IACN,OAAOrB,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC;EAC1C;;;uBAvDWT,WAAW,EAAA8B,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA;IAAA;EAAA;;;aAAXjC,WAAW;MAAAkC,OAAA,EAAXlC,WAAW,CAAAmC,IAAA;MAAAC,UAAA,EAFV;IAAM;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}