{"ast":null,"code":"import { BehaviorSubject } from \"rxjs\";\nimport { tap } from \"rxjs/operators\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class AuthService {\n  constructor(http) {\n    this.http = http;\n    this.apiUrl = \"http://localhost:8080/api/auth\";\n    this.currentUserSubject = new BehaviorSubject(null);\n    this.currentUser$ = this.currentUserSubject.asObservable();\n    // Check if user is already logged in\n    const token = localStorage.getItem(\"authToken\");\n    if (token) {\n      // You might want to validate the token with the backend\n      this.getCurrentUser().subscribe();\n    }\n  }\n  login(credentials) {\n    return this.http.post(`${this.apiUrl}/login`, credentials).pipe(tap(response => {\n      localStorage.setItem(\"authToken\", response.token);\n      this.currentUserSubject.next(response.user);\n    }));\n  }\n  register(userData) {\n    return this.http.post(`${this.apiUrl}/register`, userData).pipe(tap(response => {\n      localStorage.setItem(\"authToken\", response.token);\n      this.currentUserSubject.next(response.user);\n    }));\n  }\n  forgotPassword(email) {\n    return this.http.post(`${this.apiUrl}/forgot-password`, {\n      email\n    });\n  }\n  logout() {\n    localStorage.removeItem(\"authToken\");\n    this.currentUserSubject.next(null);\n  }\n  getCurrentUser() {\n    return this.http.get(`${this.apiUrl}/me`);\n  }\n  isAuthenticated() {\n    return !!localStorage.getItem(\"authToken\");\n  }\n  getToken() {\n    return localStorage.getItem(\"authToken\");\n  }\n  static {\n    this.ɵfac = function AuthService_Factory(t) {\n      return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: AuthService,\n      factory: AuthService.ɵfac,\n      providedIn: \"root\"\n    });\n  }\n}","map":{"version":3,"names":["BehaviorSubject","tap","AuthService","constructor","http","apiUrl","currentUserSubject","currentUser$","asObservable","token","localStorage","getItem","getCurrentUser","subscribe","login","credentials","post","pipe","response","setItem","next","user","register","userData","forgotPassword","email","logout","removeItem","get","isAuthenticated","getToken","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["C:\\Users\\foulm\\Downloads\\v12\\src\\app\\services\\auth.service.ts"],"sourcesContent":["import { Injectable } from \"@angular/core\"\nimport { HttpClient } from \"@angular/common/http\"\nimport { type Observable, BehaviorSubject } from \"rxjs\"\nimport { tap } from \"rxjs/operators\"\n\nexport interface User {\n  id: number\n  username: string\n  email: string\n  firstName: string\n  lastName: string\n}\n\nexport interface LoginRequest {\n  username: string\n  password: string\n}\n\nexport interface RegisterRequest {\n  username: string\n  email: string\n  password: string\n  firstName: string\n  lastName: string\n}\n\nexport interface AuthResponse {\n  token: string\n  user: User\n}\n\n@Injectable({\n  providedIn: \"root\",\n})\nexport class AuthService {\n  private apiUrl = \"http://localhost:8080/api/auth\"\n  private currentUserSubject = new BehaviorSubject<User | null>(null)\n  public currentUser$ = this.currentUserSubject.asObservable()\n\n  constructor(private http: HttpClient) {\n    // Check if user is already logged in\n    const token = localStorage.getItem(\"authToken\")\n    if (token) {\n      // You might want to validate the token with the backend\n      this.getCurrentUser().subscribe()\n    }\n  }\n\n  login(credentials: LoginRequest): Observable<AuthResponse> {\n    return this.http.post<AuthResponse>(`${this.apiUrl}/login`, credentials).pipe(\n      tap((response) => {\n        localStorage.setItem(\"authToken\", response.token)\n        this.currentUserSubject.next(response.user)\n      }),\n    )\n  }\n\n  register(userData: RegisterRequest): Observable<AuthResponse> {\n    return this.http.post<AuthResponse>(`${this.apiUrl}/register`, userData).pipe(\n      tap((response) => {\n        localStorage.setItem(\"authToken\", response.token)\n        this.currentUserSubject.next(response.user)\n      }),\n    )\n  }\n\n  forgotPassword(email: string): Observable<any> {\n    return this.http.post(`${this.apiUrl}/forgot-password`, { email })\n  }\n\n  logout(): void {\n    localStorage.removeItem(\"authToken\")\n    this.currentUserSubject.next(null)\n  }\n\n  getCurrentUser(): Observable<User> {\n    return this.http.get<User>(`${this.apiUrl}/me`)\n  }\n\n  isAuthenticated(): boolean {\n    return !!localStorage.getItem(\"authToken\")\n  }\n\n  getToken(): string | null {\n    return localStorage.getItem(\"authToken\")\n  }\n}\n"],"mappings":"AAEA,SAA0BA,eAAe,QAAQ,MAAM;AACvD,SAASC,GAAG,QAAQ,gBAAgB;;;AA+BpC,OAAM,MAAOC,WAAW;EAKtBC,YAAoBC,IAAgB;IAAhB,KAAAA,IAAI,GAAJA,IAAI;IAJhB,KAAAC,MAAM,GAAG,gCAAgC;IACzC,KAAAC,kBAAkB,GAAG,IAAIN,eAAe,CAAc,IAAI,CAAC;IAC5D,KAAAO,YAAY,GAAG,IAAI,CAACD,kBAAkB,CAACE,YAAY,EAAE;IAG1D;IACA,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC;IAC/C,IAAIF,KAAK,EAAE;MACT;MACA,IAAI,CAACG,cAAc,EAAE,CAACC,SAAS,EAAE;;EAErC;EAEAC,KAAKA,CAACC,WAAyB;IAC7B,OAAO,IAAI,CAACX,IAAI,CAACY,IAAI,CAAe,GAAG,IAAI,CAACX,MAAM,QAAQ,EAAEU,WAAW,CAAC,CAACE,IAAI,CAC3EhB,GAAG,CAAEiB,QAAQ,IAAI;MACfR,YAAY,CAACS,OAAO,CAAC,WAAW,EAAED,QAAQ,CAACT,KAAK,CAAC;MACjD,IAAI,CAACH,kBAAkB,CAACc,IAAI,CAACF,QAAQ,CAACG,IAAI,CAAC;IAC7C,CAAC,CAAC,CACH;EACH;EAEAC,QAAQA,CAACC,QAAyB;IAChC,OAAO,IAAI,CAACnB,IAAI,CAACY,IAAI,CAAe,GAAG,IAAI,CAACX,MAAM,WAAW,EAAEkB,QAAQ,CAAC,CAACN,IAAI,CAC3EhB,GAAG,CAAEiB,QAAQ,IAAI;MACfR,YAAY,CAACS,OAAO,CAAC,WAAW,EAAED,QAAQ,CAACT,KAAK,CAAC;MACjD,IAAI,CAACH,kBAAkB,CAACc,IAAI,CAACF,QAAQ,CAACG,IAAI,CAAC;IAC7C,CAAC,CAAC,CACH;EACH;EAEAG,cAAcA,CAACC,KAAa;IAC1B,OAAO,IAAI,CAACrB,IAAI,CAACY,IAAI,CAAC,GAAG,IAAI,CAACX,MAAM,kBAAkB,EAAE;MAAEoB;IAAK,CAAE,CAAC;EACpE;EAEAC,MAAMA,CAAA;IACJhB,YAAY,CAACiB,UAAU,CAAC,WAAW,CAAC;IACpC,IAAI,CAACrB,kBAAkB,CAACc,IAAI,CAAC,IAAI,CAAC;EACpC;EAEAR,cAAcA,CAAA;IACZ,OAAO,IAAI,CAACR,IAAI,CAACwB,GAAG,CAAO,GAAG,IAAI,CAACvB,MAAM,KAAK,CAAC;EACjD;EAEAwB,eAAeA,CAAA;IACb,OAAO,CAAC,CAACnB,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC;EAC5C;EAEAmB,QAAQA,CAAA;IACN,OAAOpB,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC;EAC1C;;;uBAnDWT,WAAW,EAAA6B,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA;IAAA;EAAA;;;aAAXhC,WAAW;MAAAiC,OAAA,EAAXjC,WAAW,CAAAkC,IAAA;MAAAC,UAAA,EAFV;IAAM;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}