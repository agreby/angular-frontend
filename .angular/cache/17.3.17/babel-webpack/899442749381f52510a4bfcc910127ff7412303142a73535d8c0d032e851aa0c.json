{"ast":null,"code":"import { BehaviorSubject } from \"rxjs\";\nimport { tap } from \"rxjs/operators\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class AuthService {\n  constructor(http) {\n    this.http = http;\n    this.apiUrl = \"http://localhost:8080/api/auth\";\n    this.currentUserSubject = new BehaviorSubject(null);\n    this.currentUser$ = this.currentUserSubject.asObservable();\n    // Don't automatically call getCurrentUser on startup\n    // This prevents 403 errors when user is not logged in\n  }\n  login(credentials) {\n    return this.http.post(`${this.apiUrl}/login`, credentials).pipe(tap(response => {\n      const token = response.data?.token;\n      const user = response.data?.user;\n      localStorage.setItem(\"authToken\", token);\n      this.currentUserSubject.next(user);\n    }));\n  }\n  register(userData) {\n    return this.http.post(`${this.apiUrl}/register`, userData).pipe(tap(response => {\n      const token = response.data?.token;\n      const user = response.data?.user;\n      if (token) localStorage.setItem(\"authToken\", token);\n      if (user) this.currentUserSubject.next(user);\n    }));\n  }\n  forgotPassword(email) {\n    return this.http.post(`${this.apiUrl}/forgot-password`, {\n      email\n    });\n  }\n  logout() {\n    localStorage.removeItem(\"authToken\");\n    this.currentUserSubject.next(null);\n  }\n  getCurrentUser() {\n    return this.http.get(`${this.apiUrl}/me`);\n  }\n  isAuthenticated() {\n    const token = localStorage.getItem(\"authToken\");\n    return !!(token && token !== \"undefined\" && token !== \"null\" && token !== \"\");\n  }\n  getToken() {\n    const token = localStorage.getItem(\"authToken\");\n    if (token && token !== \"undefined\" && token !== \"null\" && token !== \"\") {\n      return token;\n    }\n    return null;\n  }\n  static {\n    this.ɵfac = function AuthService_Factory(t) {\n      return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: AuthService,\n      factory: AuthService.ɵfac,\n      providedIn: \"root\"\n    });\n  }\n}","map":{"version":3,"names":["BehaviorSubject","tap","AuthService","constructor","http","apiUrl","currentUserSubject","currentUser$","asObservable","login","credentials","post","pipe","response","token","data","user","localStorage","setItem","next","register","userData","forgotPassword","email","logout","removeItem","getCurrentUser","get","isAuthenticated","getItem","getToken","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["C:\\Users\\foulm\\Downloads\\v12\\src\\app\\services\\auth.service.ts"],"sourcesContent":["import { Injectable } from \"@angular/core\"\nimport { HttpClient } from \"@angular/common/http\"\nimport { type Observable, BehaviorSubject } from \"rxjs\"\nimport { tap } from \"rxjs/operators\"\n\nexport interface User {\n  id: number\n  username: string\n  email: string\n  firstName: string\n  lastName: string\n}\n\nexport interface LoginRequest {\n  username: string\n  password: string\n}\n\nexport interface RegisterRequest {\n  username: string\n  email: string\n  password: string\n  firstName: string\n  lastName: string\n}\n\nexport interface AuthResponse {\n  token: string\n  user: User\n}\n\n@Injectable({\n  providedIn: \"root\",\n})\nexport class AuthService {\n  private apiUrl = \"http://localhost:8080/api/auth\"\n  private currentUserSubject = new BehaviorSubject<User | null>(null)\n  public currentUser$ = this.currentUserSubject.asObservable()\n\n  constructor(private http: HttpClient) {\n    // Don't automatically call getCurrentUser on startup\n    // This prevents 403 errors when user is not logged in\n  }\n\n  login(credentials: LoginRequest): Observable<any> {\n    return this.http.post<any>(`${this.apiUrl}/login`, credentials).pipe(\n      tap((response) => {\n        const token = response.data?.token;\n        const user = response.data?.user;\n        localStorage.setItem(\"authToken\", token);\n        this.currentUserSubject.next(user);\n      }),\n    );\n  }\n\n  register(userData: RegisterRequest): Observable<any> {\n    return this.http.post<any>(`${this.apiUrl}/register`, userData).pipe(\n      tap((response) => {\n        const token = response.data?.token;\n        const user = response.data?.user;\n        if (token) localStorage.setItem(\"authToken\", token);\n        if (user) this.currentUserSubject.next(user);\n      }),\n    );\n  }\n\n  forgotPassword(email: string): Observable<any> {\n    return this.http.post(`${this.apiUrl}/forgot-password`, { email })\n  }\n\n  logout(): void {\n    localStorage.removeItem(\"authToken\")\n    this.currentUserSubject.next(null)\n  }\n\n  getCurrentUser(): Observable<User> {\n    return this.http.get<User>(`${this.apiUrl}/me`)\n  }\n\n  isAuthenticated(): boolean {\n    const token = localStorage.getItem(\"authToken\");\n    return !!(token && token !== \"undefined\" && token !== \"null\" && token !== \"\");\n  }\n\n  getToken(): string | null {\n    const token = localStorage.getItem(\"authToken\");\n    if (token && token !== \"undefined\" && token !== \"null\" && token !== \"\") {\n      return token;\n    }\n    return null;\n  }\n}\n"],"mappings":"AAEA,SAA0BA,eAAe,QAAQ,MAAM;AACvD,SAASC,GAAG,QAAQ,gBAAgB;;;AA+BpC,OAAM,MAAOC,WAAW;EAKtBC,YAAoBC,IAAgB;IAAhB,KAAAA,IAAI,GAAJA,IAAI;IAJhB,KAAAC,MAAM,GAAG,gCAAgC;IACzC,KAAAC,kBAAkB,GAAG,IAAIN,eAAe,CAAc,IAAI,CAAC;IAC5D,KAAAO,YAAY,GAAG,IAAI,CAACD,kBAAkB,CAACE,YAAY,EAAE;IAG1D;IACA;EACF;EAEAC,KAAKA,CAACC,WAAyB;IAC7B,OAAO,IAAI,CAACN,IAAI,CAACO,IAAI,CAAM,GAAG,IAAI,CAACN,MAAM,QAAQ,EAAEK,WAAW,CAAC,CAACE,IAAI,CAClEX,GAAG,CAAEY,QAAQ,IAAI;MACf,MAAMC,KAAK,GAAGD,QAAQ,CAACE,IAAI,EAAED,KAAK;MAClC,MAAME,IAAI,GAAGH,QAAQ,CAACE,IAAI,EAAEC,IAAI;MAChCC,YAAY,CAACC,OAAO,CAAC,WAAW,EAAEJ,KAAK,CAAC;MACxC,IAAI,CAACR,kBAAkB,CAACa,IAAI,CAACH,IAAI,CAAC;IACpC,CAAC,CAAC,CACH;EACH;EAEAI,QAAQA,CAACC,QAAyB;IAChC,OAAO,IAAI,CAACjB,IAAI,CAACO,IAAI,CAAM,GAAG,IAAI,CAACN,MAAM,WAAW,EAAEgB,QAAQ,CAAC,CAACT,IAAI,CAClEX,GAAG,CAAEY,QAAQ,IAAI;MACf,MAAMC,KAAK,GAAGD,QAAQ,CAACE,IAAI,EAAED,KAAK;MAClC,MAAME,IAAI,GAAGH,QAAQ,CAACE,IAAI,EAAEC,IAAI;MAChC,IAAIF,KAAK,EAAEG,YAAY,CAACC,OAAO,CAAC,WAAW,EAAEJ,KAAK,CAAC;MACnD,IAAIE,IAAI,EAAE,IAAI,CAACV,kBAAkB,CAACa,IAAI,CAACH,IAAI,CAAC;IAC9C,CAAC,CAAC,CACH;EACH;EAEAM,cAAcA,CAACC,KAAa;IAC1B,OAAO,IAAI,CAACnB,IAAI,CAACO,IAAI,CAAC,GAAG,IAAI,CAACN,MAAM,kBAAkB,EAAE;MAAEkB;IAAK,CAAE,CAAC;EACpE;EAEAC,MAAMA,CAAA;IACJP,YAAY,CAACQ,UAAU,CAAC,WAAW,CAAC;IACpC,IAAI,CAACnB,kBAAkB,CAACa,IAAI,CAAC,IAAI,CAAC;EACpC;EAEAO,cAAcA,CAAA;IACZ,OAAO,IAAI,CAACtB,IAAI,CAACuB,GAAG,CAAO,GAAG,IAAI,CAACtB,MAAM,KAAK,CAAC;EACjD;EAEAuB,eAAeA,CAAA;IACb,MAAMd,KAAK,GAAGG,YAAY,CAACY,OAAO,CAAC,WAAW,CAAC;IAC/C,OAAO,CAAC,EAAEf,KAAK,IAAIA,KAAK,KAAK,WAAW,IAAIA,KAAK,KAAK,MAAM,IAAIA,KAAK,KAAK,EAAE,CAAC;EAC/E;EAEAgB,QAAQA,CAAA;IACN,MAAMhB,KAAK,GAAGG,YAAY,CAACY,OAAO,CAAC,WAAW,CAAC;IAC/C,IAAIf,KAAK,IAAIA,KAAK,KAAK,WAAW,IAAIA,KAAK,KAAK,MAAM,IAAIA,KAAK,KAAK,EAAE,EAAE;MACtE,OAAOA,KAAK;;IAEd,OAAO,IAAI;EACb;;;uBAxDWZ,WAAW,EAAA6B,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA;IAAA;EAAA;;;aAAXhC,WAAW;MAAAiC,OAAA,EAAXjC,WAAW,CAAAkC,IAAA;MAAAC,UAAA,EAFV;IAAM;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}